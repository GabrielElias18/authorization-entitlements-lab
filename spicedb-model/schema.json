{
  "schema": "caveat within_active_range(start timestamp, end timestamp, now timestamp) {\n  now >= start && now <= end\n}\n\ncaveat under_limit(max_amount int, amount int) {\n  amount <= max_amount\n}\n\ncaveat within_time_and_limit(max_amount int, amount int, start timestamp, end timestamp, now timestamp) {\n  amount <= max_amount && now >= start && now <= end\n}\n\ndefinition user {}\n\ndefinition org {\n  relation member: user | role\n  permission can_access = member + member->member\n}\n\ndefinition role {\n  relation member: user\n}\n\ndefinition account {\n  relation owner: user | org\n  relation delegated_access: poa\n  relation accountant_access: user with within_active_range\n  permission can_view_transactions = owner + owner->member + delegated_access->can_view_transactions + accountant_access\n  permission can_download_statement = owner + owner->member + delegated_access->can_download_statement + accountant_access\n  permission can_initiate_payment = owner + owner->member + delegated_access->can_initiate_payment\n}\n\ndefinition poa {\n  relation delegate_with_limit: user with under_limit\n  relation delegate_with_time: user with within_active_range\n  relation delegate_with_time_and_limit: user with within_time_and_limit\n  permission can_view_transactions = delegate_with_limit + delegate_with_time + delegate_with_time_and_limit\n  permission can_download_statement = delegate_with_limit + delegate_with_time + delegate_with_time_and_limit\n  permission can_initiate_payment = delegate_with_limit + delegate_with_time + delegate_with_time_and_limit\n}"
} 